
<header class="page-header bg-img" style="background-image: url(assets/img/bg-banner1.jpg);">
  <div class="container page-name">
    <h1 class="text-center">Manage your posted jobs</h1>
    <p class="lead text-center">Here's the list of your submitted jobs. You can edit or delete them, or even add a new one.</p>
  </div>
  <div class="container">
    <%= form_tag(posts_path, method: :get) do %>

        <div class="row">
          <div class="form-group col-xs-12 col-sm-6">
            <h6>Keywords</h6>
            <%= text_field_tag :searched_keyword, params[:searched_keyword], class: "form-control", placeholder: "Keyword: job title, description, or requirements" %>
          </div>
          <div class="form-group col-xs-12 col-sm-6">
            <h6>Address</h6>
            <%= text_field_tag :address, params[:address], class: "form-control", placeholder: "Location: city, state or zip" %>
          </div>

          <div class="form-group col-xs-12 col-sm-3">
            <h6>Category</h6>
            <%= select_tag :category_id, options_from_collection_for_select(ServiceCategory.order(:title), :id, :title, params[:category_id]), {id: "post_category_id", include_blank: 'All', class: 'form-control selectpicker'} %>
          </div>

          <div class="form-group col-xs-12 col-sm-3">
            <h6>Type</h6>
            <%= select_tag :type_id, option_groups_from_collection_for_select(ServiceCategory.order(:title), :service_types, :title, :id, :title, params[:type_id]), {id: "post_type_id", include_blank: 'All', class: 'form-control selectpicker'} %>
          </div>

          <div class="form-group col-xs-12 col-sm-3">
            <h6>Status</h6>
            <%= select_tag :status, options_for_select([['Open', 'open'], ['Close', 'close']], params[:status]), {:include_blank => 'All', class: 'form-control selectpicker'} %>
          </div>

          <div class="form-group col-xs-12 col-sm-3">
            <h6>Order By</h6>
            <%= select_tag :order, options_for_select([["update time", "updated_at"], ["create time", "created_at"]], params[:order]), {:include_blank => 'Default', class: 'form-control selectpicker'} %>
          </div>

          <div id="infowindow-content">
            <img src="" width="16" height="16" id="place-icon">
            <span id="place-name" class="title"></span><br>
            <span id="place-address"></span>
          </div>
          <%= javascript_tag "all_posts = #{@posts.to_json};" %>
          <script>
              var post_id = -1;
          </script>

          <!--
        <div class="form-group col-xs-12 col-sm-6">
          <h6>Job Category</h6>
          <div class="checkall-group">
            <div class="checkbox">
              <input type="checkbox" id="service_category_all" name="service_category" checked>
              <label for="service_category_all">All types</label>
            </div>

            <% ServiceCategory.all.each do |category| %>
              <div class="checkbox">
                <input type="checkbox" id=<%= "service_category_#{category.id}" %> name="service_category" value=<%= category.title.parameterize.underscore %>>
                <label for=<%= "service_category_#{category.id}" %>><%= category.title %></label>
              </div>
            <% end %>
          </div>
        </div>

        <div class="form-group col-xs-12 col-sm-6">
          <h6>Job Type</h6>
          <div class="checkall-group">
            <div class="checkbox">
              <input type="checkbox" id="service_type_all" name="service_type" checked>
              <label for="service_type_all">All types</label>
            </div>

            <% ServiceType.all.each do |type| %>
              <div class="checkbox">
                <input type="checkbox" id=<%= "service_type_#{type.id}" %> value=<%= type.service_category.title.parameterize.underscore %> name="service_type">
                <label for=<%= "service_type_#{type.id}" %>><%= type.title %></label>
              </div>
            <% end %>
          </div>
        </div>
      -->
        </div>




        <div class="button-group">

          <div class="action-buttons">
            <%= submit_tag 'Apply filter', name: nil, class: 'btn btn-primary' %>
          </div>

          <div class="action-buttons">
            <%= link_to 'Post a Service' , new_post_path, class: 'btn btn-success' %>
          </div>

        </div>

    <% end %>

  </div>
</header>


<main>
  <section class="no-padding-top bg-alt">
    <div class="container">
      <div class="row">



        <% @posts.each do |post| %>
            <div class="col-xs-12">
              <div class="item-block">
                <header>

                  <div class="row">

                    <span class="fa-stack fa-lg fa-3x col-xs-12 col-sm-2">
                    <i class="fa <%= post.service_category.get_fa %> fa-stack-1x"></i>
                  </span>
                  <div class="hgroup  col-xs-12 col-sm-6">

                    <%= link_to  "#{post.title}", post, class: 'h4'%>
                    <h5>Description</h5>
                    <p><%= post.description %></p>
                  </div>
                  <div class="header-meta  col-xs-12 col-sm-4">
                    <span class="location"><%= post.work_address %></span>
                    <time datetime=<%= post.updated_at %>>Updated at <%= post.updated_at.in_time_zone('Eastern Time (US & Canada)').strftime("%b %d %Y %H:%M") %></time>
                  </div>
                </div>
                </header>

                <footer>
                  <p class="status"><strong>Status: </strong><%= post.hasPosition %></p>

                  <div class="action-btn">
                    <%= link_to 'Edit', edit_post_path(post), class: 'btn btn-xs btn-gray'%>
                    <%= link_to 'Delete', { action: :destroy, id: post.id }, method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-xs btn-danger'  %>
                  </div>
                </footer>
              </div>
            </div>
        <% end %>
      </div>
      <!-- Page navigation -->
      <nav class="text-center">
        <%= will_paginate @posts, renderer: BootstrapPagination::Rails %>
      </nav>
      <!-- END Page navigation -->
    </div>
    <a id="scroll-up" href="#"><i class="ti-angle-up"></i></a>
  </section>
</main>